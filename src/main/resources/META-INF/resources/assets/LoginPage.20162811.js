import{a as y,Q as F}from"./QCard.5bd61516.js";import{Q as C}from"./QInput.b6fc7cf4.js";import{k as B,r as A,ab as I,Y as k,aq as L,u as R,y as U,A as j,C as z,Z as D,s as Q,v as N,an as O,_ as T,O as E,E as K,F as G,G as d,K as u,L as M,I as f,S as W}from"./index.a76fad5b.js";import{b as Y}from"./focus-manager.02955f48.js";import{Q as Z}from"./QPage.674f3cdd.js";import{_ as $}from"./logo.2b5e97da.js";import"./use-dark.78938834.js";var H=B({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(s,{slots:c,emit:m}){const _=z(),n=A(null);let l=0;const t=[];function b(e){const i=typeof e=="boolean"?e:s.noErrorFocus!==!0,v=++l,w=(o,a)=>{m("validation"+(o===!0?"Success":"Error"),a)},P=o=>{const a=o.validate();return typeof a.then=="function"?a.then(r=>({valid:r,comp:o}),r=>({valid:!1,comp:o,err:r})):Promise.resolve({valid:a,comp:o})};return(s.greedy===!0?Promise.all(t.map(P)).then(o=>o.filter(a=>a.valid!==!0)):t.reduce((o,a)=>o.then(()=>P(a).then(r=>{if(r.valid===!1)return Promise.reject(r)})),Promise.resolve()).catch(o=>[o])).then(o=>{if(o===void 0||o.length===0)return v===l&&w(!0),!0;if(v===l){const{comp:a,err:r}=o[0];if(r!==void 0&&console.error(r),w(!1,a),i===!0){const V=o.find(({comp:q})=>typeof q.focus=="function"&&D(q.$)===!1);V!==void 0&&V.comp.focus()}}return!1})}function g(){l++,t.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function h(e){e!==void 0&&Q(e);const i=l+1;b().then(v=>{i===l&&v===!0&&(s.onSubmit!==void 0?m("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function x(e){e!==void 0&&Q(e),m("reset"),N(()=>{g(),s.autofocus===!0&&s.noResetFocus!==!0&&p()})}function p(){Y(()=>{if(n.value===null)return;const e=n.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||n.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||n.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(n.value.querySelectorAll("[tabindex]"),i=>i.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}I(O,{bindComponent(e){t.push(e)},unbindComponent(e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}});let S=!1;return k(()=>{S=!0}),L(()=>{S===!0&&s.autofocus===!0&&p()}),R(()=>{s.autofocus===!0&&p()}),Object.assign(_.proxy,{validate:b,resetValidation:g,submit:h,reset:x,focus:p,getValidationComponents:()=>t}),()=>U("form",{class:"q-form",ref:n,onSubmit:h,onReset:x},j(c.default))}});const J={name:"LoginPage",data(){return{form:{username:"",password:""}}},methods:{onSubmit(){E().login(this.form.username,this.form.password,this)}},mounted(){const s=E();s.accessToken!==null&&s.userData!==null&&this.$router.push("/")}},X=f("h4",{class:"text-weight-bold qa-none q-my-none"},"Sign in",-1),ee=f("img",{alt:"Quasar logo",src:$},null,-1),te={class:"q-pa-md",style:{"max-width":"400px"}},oe=f("div",null,"Enter your username or email address",-1),se=f("div",null,"Enter your password",-1);function ne(s,c,m,_,n,l){return K(),G(Z,{padding:"",class:"bg-secondary flex flex-center"},{default:d(()=>[u(F,{class:"my-card q-pa-lg"},{default:d(()=>[u(y,{horizontal:"",class:"row justify-between items-start content-start"},{default:d(()=>[u(y,null,{default:d(()=>[M(" Welcome to "),X]),_:1}),u(y,null,{default:d(()=>[ee]),_:1})]),_:1}),u(y,null,{default:d(()=>[f("div",te,[u(H,{onSubmit:l.onSubmit,class:"q-gutter-md"},{default:d(()=>[oe,u(C,{dense:"",outlined:"",modelValue:n.form.username,"onUpdate:modelValue":c[0]||(c[0]=t=>n.form.username=t),label:"Username or email address","lazy-rules":"",rules:[t=>t&&t.length>0||"Please type something"]},null,8,["modelValue","rules"]),se,u(C,{dense:"",outlined:"",type:"password",modelValue:n.form.password,"onUpdate:modelValue":c[1]||(c[1]=t=>n.form.password=t),label:"Password","lazy-rules":"",rules:[t=>t!==null&&t!==""||"Please type your password"]},null,8,["modelValue","rules"]),f("div",null,[u(W,{label:"Sign in",type:"submit",color:"blue-7",class:"full-width"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1})]),_:1})}var me=T(J,[["render",ne]]);export{me as default};
